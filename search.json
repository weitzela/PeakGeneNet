[{"path":"https://weitzela.github.io/PeakGeneNet/articles/workflow.html","id":"data-preparation","dir":"Articles","previous_headings":"","what":"1. Data Preparation","title":"workflow","text":"Required objects: Gene counts: matrix row names ensembl IDs   R18804   R18805   R18809   ENSRNOG00000000008   6.226779   6.150745   6.388451   ENSRNOG00000000082   7.267295   7.324605   7.220238   ENSRNOG00000001489   7.768652   8.032395   7.814327 Peak counts: list object one matrices. Matrices format gene counts, row names genomic region chromosome names, start, end locations separaated punctuation mark (e.g., chr1:123:456 chr1:123-456).    PL119617   PL119618   PL119619   chr2:103325658:103326019   6.616630   6.816892   6.210107   chr2:103337000:103337431   7.643895   7.417112   7.204352   chr2:103483778:103484423   7.449124   7.336309   7.031643   chr3:78634005:78634640   6.754136   6.966854   7.031643   chr3:78652614:78653063   6.707064   6.966854   6.674483   chr3:78702369:78702924   6.890375   7.033393   7.272677 Use objects create peak-gene pairs inclusion correlation analysis. p2g_info provides information individual peaks per gene correlated . correlation_pairs object used reference correlations run. See many relationships tested within category.  , carry process correlations using following functions. count matrices used input correlation analysis samples rows features columns.","code":"p2g_ls = createPeak2GeneObjects(   rownames(gene_counts), peak_counts |> map(rownames),    biomaRt::useEnsembl(biomart = \"genes\",                        dataset = \"rnorvegicus_gene_ensembl\", version = 109),    \"rn7\" ) p2g_ls$p2g_info[1:5,] |> kableExtra::kable() p2g_ls$correlation_pairs[1:5,] |> kableExtra::kable() p2g_ls$correlation_pairs |>    select(-ensembl_gene_id) |>    distinct() |>    group_by(link_label, modality_pair) |>    tally(name = \"No. of Correlations\") |>    janitor::adorn_totals(where = c(\"row\")) |>    mutate(across(where(is.numeric), scales::comma)) |>    kableExtra::kable() tmp_mat = t(gene_counts)[,c(1,1)] !duplicated(colnames(tmp_mat)) #> [1]  TRUE FALSE tmp_mat[,-duplicated(colnames(tmp_mat)),drop=FALSE] #>        ENSRNOG00000000008 #> R18804           6.226779 #> R18805           6.150745 #> R18809           6.388451 #> R18810           6.201142 #> R18819           6.328846 #> R18820           6.287093 #> R18821           5.827359 #> R18827           6.009111 #> R18828           6.206376 #> R18829           6.216744 #> R18839           6.284814 #> R18840           6.560351 #> R18841           6.306194 #> R18842           6.200470 #> R18843           6.302628 #> R18850           6.300516 #> R18851           6.154064 #> R18852           6.218144 #> R18856           6.116110 #> R18857           6.163643 #> R18858           6.473600 #> R18859           6.092026 #> R18860           6.256806 #> R18861           6.135792 #> R18879           6.300636 #> R18880           6.510249 #> R18885           6.139304 #> R18886           6.323827 #> R18887           6.240320 #> R18888           5.841920 #> R18889           6.464813 #> R18890           5.969445 #> R18900           6.208546 #> R18901           6.240876 #> R18909           6.061753 #> R18910           6.390905 #> R18917           6.200783 #> R18918           6.373255 #> R18919           6.354534 #> R18933           6.389630 #> R18934           6.294382 #> R18935           6.357744 #> R18936           6.019776 #> R18949           5.526674 #> R18950           6.372019 #> R18951           6.678617 #> R18954           6.494188 #> R18955           6.221581 #> R18956           6.262311 #> R18962           6.570335 #> R18963           6.221500 #> R18972           6.246718 #> R18973           6.244364 #> R18974           6.323325 #> R18975           6.462049 #> R18976           6.361749 #> R18979           6.204799 #> R18980           6.346200 #> R18981           6.470114 #> R18997           6.323925 #> R18998           6.120808 #> R18999           6.019391 #> R19014           6.140557 #> R19015           6.569781 #> R28311           6.017178 #> R28312           6.152096 #> R28313           6.167043 #> R28321           6.262532 #> R28322           6.291001 #> R28327           6.331873 #> R28328           6.373952 #> R28329           6.014881 #> R28336           6.164190 #> R28337           6.246948 #> R28338           5.911523 #> R28339           6.107326 #> R28340           5.953431 #> R28348           6.476898 #> R28349           6.215214 #> R28353           6.198157 #> R28354           6.139912 #> R28358           6.213172 #> R28359           6.239303 #> R28375           6.463560 #> R28376           6.542750 #> R28377           6.251136 #> R28381           6.312130 #> R28382           5.994931 #> R28383           5.735034 #> R28387           6.129441 #> R28388           6.119432 #> R28393           6.417523 #> R28394           6.306894 #> R28395           6.238548 #> R28400           6.182375 #> R28401           6.135212 #> R28402           6.032087 #> R28408           6.298229 #> R28409           6.053847 #> R28416           5.998940 #> R28417           6.138375 #> R28423           6.222035 #> R28424           6.326649 #> R28425           6.135861 #> R28427           6.282609 #> R28434           6.427184 #> R28436           6.434721 #> R28437           6.395132 #> R28453           6.285133 #> R28454           5.911657 #> R28456           6.371622 #> R28457           6.239782 #> R28463           6.127067 #> R28464           6.287524 #> R28470           6.235805 #> R28471           6.389448 #> R28481           6.335875 #> R28483           6.081721 #> R28489           6.195184 #> R28490           6.361663 #> R28503           6.260248 #> R28504           6.331142 #> R28511           6.439461 #> R28512           6.186302 #> R28514           6.175235 #> R28515           6.028437 #> R28518           6.257430 #> R28519           5.991977 peak_counts_t = map(peak_counts, function(.x) {   colnames(.x) = attr(.x, \"samp\")[colnames(.x), \"samp_id\"]   return(t(.x)) }) count_mat = formatMatrixForCorrelation(t(gene_counts), peak_counts_t) count_mat[1:5,1:5] |> kableExtra::kable() full_cor_res = correlateByChromosome(count_mat, p2g_ls$correlation_pairs) #> Starting chr1 #> 0.021 sec elapsed #> Starting chr2 #> 0.007 sec elapsed #> Starting chr3 #> 0.331 sec elapsed #> Joining with `by = join_by(regulatory_element, target_id, link_label, chr, #> modality_pair, r, n, P)` full_cor_res |> head(5) |> kableExtra::kable() processed_cor = processCorrelations(count_mat, full_cor_res, p2g_ls$correlation_pairs, p2g_ls$p2g_info) #> Joining with `by = join_by(ensembl_gene_id, regulatory_element)` #> Joining with `by = join_by(ensembl_gene_id, regulatory_element, target_id)` #> Joining with `by = join_by(ensembl_gene_id, regulatory_element, target_id)` #> ### Correlating ambiguous peaks with other distal peaks assocaited with gene #> ### pre fxn: disclude: 74 neg: 22 pos: 22 #> round 1: disclude: 2 drop: 27 neg: 44 pos: 45 #> round 2: disclude: 1 drop: 27 neg: 44 pos: 46 #> round 3: disclude: 1 drop: 27 neg: 44 pos: 46 #> round 4: disclude: 1 drop: 27 neg: 44 pos: 46 #> round 5: drop: 28 neg: 44 pos: 46 processed_cor |> head(5) |> kableExtra::kable() sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #>  [1] PeakGeneNet_0.1.0 lubridate_1.9.4   forcats_1.0.1     stringr_1.6.0     #>  [5] dplyr_1.1.4       purrr_1.2.1       readr_2.1.6       tidyr_1.3.2       #>  [9] tibble_3.3.1      ggplot2_4.0.1     tidyverse_2.0.0   #>  #> loaded via a namespace (and not attached): #>  [1] tidyselect_1.2.1     viridisLite_0.4.2    farver_2.1.2         #>  [4] blob_1.3.0           filelock_1.0.3       Biostrings_2.78.0    #>  [7] S7_0.2.1             fastmap_1.2.0        BiocFileCache_3.0.0  #> [10] janitor_2.2.1        digest_0.6.39        timechange_0.3.0     #> [13] lifecycle_1.0.5      KEGGREST_1.50.0      RSQLite_2.4.5        #> [16] magrittr_2.0.4       compiler_4.5.2       rlang_1.1.7          #> [19] sass_0.4.10          progress_1.2.3       tools_4.5.2          #> [22] yaml_2.3.12          knitr_1.51           prettyunits_1.2.0    #> [25] bit_4.6.0            curl_7.0.0           xml2_1.5.2           #> [28] RColorBrewer_1.1-3   withr_3.0.2          BiocGenerics_0.56.0  #> [31] desc_1.4.3           grid_4.5.2           stats4_4.5.2         #> [34] scales_1.4.0         gtools_3.9.5         biomaRt_2.66.0       #> [37] cli_3.6.5            rmarkdown_2.30       crayon_1.5.3         #> [40] ragg_1.5.0           generics_0.1.4       rstudioapi_0.18.0    #> [43] httr_1.4.7           tzdb_0.5.0           DBI_1.2.3            #> [46] cachem_1.1.0         AnnotationDbi_1.72.0 XVector_0.50.0       #> [49] matrixStats_1.5.0    vctrs_0.7.0          jsonlite_2.0.0       #> [52] IRanges_2.44.0       hms_1.1.4            S4Vectors_0.48.0     #> [55] bit64_4.6.0-1        systemfonts_1.3.1    jquerylib_0.1.4      #> [58] glue_1.8.0           pkgdown_2.2.0        stringi_1.8.7        #> [61] gtable_0.3.6         GenomeInfoDb_1.46.2  GenomicRanges_1.62.1 #> [64] UCSC.utils_1.6.1     pillar_1.11.1        rappdirs_0.3.4       #> [67] htmltools_0.5.9      Seqinfo_1.0.0        R6_2.6.1             #> [70] dbplyr_2.5.1         httr2_1.2.2          textshaping_1.0.4    #> [73] evaluate_1.0.5       kableExtra_1.4.0     Biobase_2.70.0       #> [76] png_0.1-8            tictoc_1.2.1         memoise_2.0.1        #> [79] snakecase_0.11.1     bslib_0.9.0          svglite_2.2.2        #> [82] xfun_0.56            fs_1.6.6             pkgconfig_2.0.3"},{"path":"https://weitzela.github.io/PeakGeneNet/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Anne Weitzel. Author, maintainer.","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Weitzel (2026). PeakGeneNet: Integration Epigenomic Peaks Genes Correlation. R package version 0.1.0, https://weitzela.github.io/PeakGeneNet/.","code":"@Manual{,   title = {PeakGeneNet: Integration of Epigenomic Peaks to Genes through Correlation},   author = {Anne Weitzel},   year = {2026},   note = {R package version 0.1.0},   url = {https://weitzela.github.io/PeakGeneNet/}, }"},{"path":"https://weitzela.github.io/PeakGeneNet/index.html","id":"peakgenenet","dir":"","previous_headings":"","what":"Integration of Epigenomic Peaks to Genes through Correlation","title":"Integration of Epigenomic Peaks to Genes through Correlation","text":"goal PeakGeneNet …","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Integration of Epigenomic Peaks to Genes through Correlation","text":"package depends multiple bioconductor packages, can resolved using pak install package. can install development version PeakGeneNet GitHub : Refer workflow article detailed walk package.","code":"# install.packages(\"pak\") pak::pak(\"weitzela/PeakGeneNet\")"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/adjustCounts.html","id":null,"dir":"Reference","previous_headings":"","what":"Adjust Counts — adjustCounts","title":"Adjust Counts — adjustCounts","text":"Adjust Counts","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/adjustCounts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adjust Counts — adjustCounts","text":"","code":"adjustCounts(   count_ls,   contrast_list = c(\"line\", \"sex\", \"grp\"),   .remove_batch_effect = TRUE )"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/adjustCountsMultipleContrasts.html","id":null,"dir":"Reference","previous_headings":"","what":"Adjust counts and protect for multiple biological contrasts Wrapper function to iterate through multiple biological contrasts to protect. This first uses the limma::removeBatchEffect function to remove technical variables such as preparation batches and flowcell. Then, it applies the adjustCovariateMatrix to further adjust for other known biological contrasts — adjustCountsMultipleContrasts","title":"Adjust counts and protect for multiple biological contrasts Wrapper function to iterate through multiple biological contrasts to protect. This first uses the limma::removeBatchEffect function to remove technical variables such as preparation batches and flowcell. Then, it applies the adjustCovariateMatrix to further adjust for other known biological contrasts — adjustCountsMultipleContrasts","text":"Adjust counts protect multiple biological contrasts Wrapper function iterate multiple biological contrasts protect. first uses limma::removeBatchEffect function remove technical variables preparation batches flowcell. , applies adjustCovariateMatrix adjust known biological contrasts","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/adjustCountsMultipleContrasts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adjust counts and protect for multiple biological contrasts Wrapper function to iterate through multiple biological contrasts to protect. This first uses the limma::removeBatchEffect function to remove technical variables such as preparation batches and flowcell. Then, it applies the adjustCovariateMatrix to further adjust for other known biological contrasts — adjustCountsMultipleContrasts","text":"","code":"adjustCountsMultipleContrasts(   count_mat,   data_label,   contrast_list = c(\"line\", \"sex\", \"grp\"),   concat_data_label = TRUE,   remove_batch_effect = TRUE )"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/adjustCovariateMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Use of matrix functions to adjust data via linear model — adjustCovariateMatrix","title":"Use of matrix functions to adjust data via linear model — adjustCovariateMatrix","text":"Use matrix functions adjust data via linear model","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/adjustCovariateMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use of matrix functions to adjust data via linear model — adjustCovariateMatrix","text":"","code":"adjustCovariateMatrix(   counts,   covariate_df,   vars_to_protect,   return_coefficients = FALSE )"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/adjustCovariateMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use of matrix functions to adjust data via linear model — adjustCovariateMatrix","text":"counts matrix transformed counts (vst, log, inverse rank normalized, etc.). sample IDs rownames, feature ID colnames covariate_df dataframe covariates, sample names rownames. order input matrix vars_to_protect character vector column names protected. coefficients calculated variables subtracted returned values return_coefficients logcal. default=FALSE","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/adjustCovariateMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use of matrix functions to adjust data via linear model — adjustCovariateMatrix","text":"matrix adjusted counts","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/assignRegion2GeneDirection.html","id":null,"dir":"Reference","previous_headings":"","what":"The results from all correlations are used to help assign direction using correlations that have a significant nominal pvalue — assignRegion2GeneDirection","title":"The results from all correlations are used to help assign direction using correlations that have a significant nominal pvalue — assignRegion2GeneDirection","text":"Directional assignments categorized 3 levels: confident: assign direction using FDR significant links agreement Directional disagreement existed, decision made taking significant FDR Directional disagreement existed, decision made taking significant nominal pvalue included comparison looser directions associated gene - neither distal promoter region nominally correlated gene, direction based peak associated distal peaks significantly linked gene high confidence. iteration identifying significant correlation peak another distal peak divided 1000 added 4. shows peak:gene relationship exists confidence level #4, notes many distal genes try correlate finding significant (pval < 0.05) connection.","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/assignRegion2GeneDirection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The results from all correlations are used to help assign direction using correlations that have a significant nominal pvalue — assignRegion2GeneDirection","text":"","code":"assignRegion2GeneDirection(sig_cor_res, all_cor_res, count_mat)"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/assignRegion2GeneDirection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The results from all correlations are used to help assign direction using correlations that have a significant nominal pvalue — assignRegion2GeneDirection","text":"sig_cor_res dataframe significant results annotate link direction all_cor_res resulting correlations count_mat matrix counts supplied correlation analysis","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/assignRegion2GeneDirection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The results from all correlations are used to help assign direction using correlations that have a significant nominal pvalue — assignRegion2GeneDirection","text":"dataframe peak-gene link annotation directions degree confidence","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/calculateDirectedDistance.html","id":null,"dir":"Reference","previous_headings":"","what":"Genomic distance with the direction — calculateDirectedDistance","title":"Genomic distance with the direction — calculateDirectedDistance","text":"function assigns negative value subject upstream target positive value subject downstream target, taking account gene located negative positive strand. function created GenomicRanges::distance function account direction TSS (upstream (-) downstream (+)).","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/calculateDirectedDistance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Genomic distance with the direction — calculateDirectedDistance","text":"","code":"calculateDirectedDistance(subject, target)"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/calculateDirectedDistance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Genomic distance with the direction — calculateDirectedDistance","text":"numeric vector signed distances","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/calculateDirectedDistance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Genomic distance with the direction — calculateDirectedDistance","text":"","code":"# example code"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/categorizeAndAnnotateCorrelationResults.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotation of genes that are significant and provide some additional downstream information for interpreting linked networks — categorizeAndAnnotateCorrelationResults","title":"Annotation of genes that are significant and provide some additional downstream information for interpreting linked networks — categorizeAndAnnotateCorrelationResults","text":"Annotation genes significant provide additional downstream information interpreting linked networks","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/categorizeAndAnnotateCorrelationResults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotation of genes that are significant and provide some additional downstream information for interpreting linked networks — categorizeAndAnnotateCorrelationResults","text":"","code":"categorizeAndAnnotateCorrelationResults(.sig_cor_genes, p2g_info)"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/categorizeAndAnnotateCorrelationResults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotation of genes that are significant and provide some additional downstream information for interpreting linked networks — categorizeAndAnnotateCorrelationResults","text":".sig_cor_genes dataframe includes genes significant correlations p2g_info dataframe","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/categorizeAndAnnotateCorrelationResults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotation of genes that are significant and provide some additional downstream information for interpreting linked networks — categorizeAndAnnotateCorrelationResults","text":"annotated dataframe","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/corWithDistalPeak.html","id":null,"dir":"Reference","previous_headings":"","what":"Iteration of correlations between distal peaks and other peaks residing near it with significant relationships with said gene — corWithDistalPeak","title":"Iteration of correlations between distal peaks and other peaks residing near it with significant relationships with said gene — corWithDistalPeak","text":"Iteration correlations distal peaks peaks residing near significant relationships said gene","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/corWithDistalPeak.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Iteration of correlations between distal peaks and other peaks residing near it with significant relationships with said gene — corWithDistalPeak","text":"","code":"corWithDistalPeak(df, full_cor_df, count_mat, iter = 1, iter_batch_cutoff = 5)"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/corWithDistalPeak.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Iteration of correlations between distal peaks and other peaks residing near it with significant relationships with said gene — corWithDistalPeak","text":"df dataframe significant correlation results full_cor_df dataframe full correlation results count_mat matrix counts supplied correlation analysis","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/corWithDistalPeak.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Iteration of correlations between distal peaks and other peaks residing near it with significant relationships with said gene — corWithDistalPeak","text":"dataframe correlation results particular iteration","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/corWithDistalPeak_wrapper.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper function for corWithDistalPeak to iterate through the correlations — corWithDistalPeak_wrapper","title":"Wrapper function for corWithDistalPeak to iterate through the correlations — corWithDistalPeak_wrapper","text":"Wrapper function corWithDistalPeak iterate correlations","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/corWithDistalPeak_wrapper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper function for corWithDistalPeak to iterate through the correlations — corWithDistalPeak_wrapper","text":"","code":"corWithDistalPeak_wrapper(   full_cor_df,   count_mat,   v = TRUE,   .iter_batch_cutoff = 5 )"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/corWithDistalPeak_wrapper.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper function for corWithDistalPeak to iterate through the correlations — corWithDistalPeak_wrapper","text":"full_cor_df dataframe full correlation results count_mat matrix counts supplied correlation analysis v logical. print informative messages","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/corWithDistalPeak_wrapper.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper function for corWithDistalPeak to iterate through the correlations — corWithDistalPeak_wrapper","text":"dataframe iterated correlation results significant correlation identified distal peaks","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/correlateByChromosome.html","id":null,"dir":"Reference","previous_headings":"","what":"A wrapper function to carry out correlations in smaller chunks to help save on memory — correlateByChromosome","title":"A wrapper function to carry out correlations in smaller chunks to help save on memory — correlateByChromosome","text":"wrapper function carry correlations smaller chunks help save memory","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/correlateByChromosome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A wrapper function to carry out correlations in smaller chunks to help save on memory — correlateByChromosome","text":"","code":"correlateByChromosome(   count_mat,   correlation_pairs,   grp_contrast = NULL,   rds_fn = NULL )"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/correlateByChromosome.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A wrapper function to carry out correlations in smaller chunks to help save on memory — correlateByChromosome","text":"count_mat numeric matrix features columns samples rows correlation_pairs dataframe supplying pairs features grp_contrast way filter include samples certain groups rds_fn filename save output future access","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/correlateByChromosome.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A wrapper function to carry out correlations in smaller chunks to help save on memory — correlateByChromosome","text":"dataframe full results","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/createPeak2GeneObjects.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Peak-Gene Links Set up genomicranges objects for the data included in the correlation analysis. Data matrices must have unique feature IDs. — createPeak2GeneObjects","title":"Create Peak-Gene Links Set up genomicranges objects for the data included in the correlation analysis. Data matrices must have unique feature IDs. — createPeak2GeneObjects","text":"Create Peak-Gene Links Set genomicranges objects data included correlation analysis. Data matrices must unique feature IDs.","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/createPeak2GeneObjects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Peak-Gene Links Set up genomicranges objects for the data included in the correlation analysis. Data matrices must have unique feature IDs. — createPeak2GeneObjects","text":"","code":"createPeak2GeneObjects(genes, peaks, biomart_ensembl, ucsc_genome)"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/createPeak2GeneObjects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Peak-Gene Links Set up genomicranges objects for the data included in the correlation analysis. Data matrices must have unique feature IDs. — createPeak2GeneObjects","text":"genes either character vector ensembl IDs matrix row column names ensembl IDs peaks named list character vectors containing renomic region. Genomic regions begin \"chr\". list can also contain count matrices, row names column names genomic regions.","code":""},{"path":[]},{"path":"https://weitzela.github.io/PeakGeneNet/reference/createTSSGr.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup gene TSS object — createTSSGr","title":"Setup gene TSS object — createTSSGr","text":"creates dataframe canonical TSS gene included analysis","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/createTSSGr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup gene TSS object — createTSSGr","text":"","code":"createTSSGr(ensembl_ids, biomart_ensembl, ucsc_genome)"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/createTSSGr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup gene TSS object — createTSSGr","text":"ucsc_genome genome release formatting ucsc style. example: hg38, rn7, etc.","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/createTSSGr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Setup gene TSS object — createTSSGr","text":"","code":"# createTSSObject(c(\"ENSR00129\", \"ENSR00139\"), biomaRt::useEnsembl(biomart = \"genes\", dataset = \"hsapiens_gene_ensembl\", version = 105), \"hg38\")"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/editCorResFields.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotation of significant promoter peak information — editCorResFields","title":"Annotation of significant promoter peak information — editCorResFields","text":"Annotation significant promoter peak information","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/editCorResFields.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotation of significant promoter peak information — editCorResFields","text":"","code":"editCorResFields(df)"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/editCorResFields.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotation of significant promoter peak information — editCorResFields","text":"df correlation results","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/editCorResFields.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotation of significant promoter peak information — editCorResFields","text":"annotated dataframe","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/formatMatrixForCorrelation.html","id":null,"dir":"Reference","previous_headings":"","what":"Format input — formatMatrixForCorrelation","title":"Format input — formatMatrixForCorrelation","text":"function pastes modality end feature ID combines matrices one matrix object. matrices must common sample IDs rownames join .","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/formatMatrixForCorrelation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format input — formatMatrixForCorrelation","text":"","code":"formatMatrixForCorrelation(gene_counts, peak_counts)"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/formatMatrixForCorrelation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format input — formatMatrixForCorrelation","text":"gene_counts count matrix rownames sample IDs colnames feature ID","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/gene_counts.html","id":null,"dir":"Reference","previous_headings":"","what":"Example Gene Counts — gene_counts","title":"Example Gene Counts — gene_counts","text":"matrix containing example gene count data. pulled larger dataset VST transformed.","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/gene_counts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example Gene Counts — gene_counts","text":"","code":"gene_counts"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/gene_counts.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example Gene Counts — gene_counts","text":"matrix 3 rows 128 columns Rows Genes Columns Samples","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/gene_counts.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example Gene Counts — gene_counts","text":"University Michigan","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/matrixCorrelation.html","id":null,"dir":"Reference","previous_headings":"","what":"Correlation of two matrices for more efficient calculations — matrixCorrelation","title":"Correlation of two matrices for more efficient calculations — matrixCorrelation","text":"Correlation two matrices efficient calculations","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/matrixCorrelation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correlation of two matrices for more efficient calculations — matrixCorrelation","text":"","code":"matrixCorrelation(   mat1,   mat2,   type = c(\"pearson\", \"spearman\"),   rank_data = FALSE,   return_pvalue = TRUE )"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/matrixCorrelation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correlation of two matrices for more efficient calculations — matrixCorrelation","text":"mat1 first matrix data correlate mat2 must dimensions mat1 type method correlation rank_data logical return_pvalue default=TRUE","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/matrixCorrelation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correlation of two matrices for more efficient calculations — matrixCorrelation","text":"dataframe five columns containing pairs data correlated, correlation coefficient, p-value, number samples included correlation.","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/matrixCorrelation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Correlation of two matrices for more efficient calculations — matrixCorrelation","text":"","code":"# example code"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/peak_counts.html","id":null,"dir":"Reference","previous_headings":"","what":"Example Peak Counts — peak_counts","title":"Example Peak Counts — peak_counts","text":"list matrices containing VST transformed counts multiple modalities integrated. matrices include features (peaks) rows samples columns. matrix contains \"sample_info\" attribute dataframe provides metadata information used data normalization. rownames identical column names respective matrix. dataframe include numeric factor data.","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/peak_counts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example Peak Counts — peak_counts","text":"","code":"peak_counts"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/peak_counts.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example Peak Counts — peak_counts","text":"list matrices H3K27ac matrix H3K27ac count data 124 rows 59 columns H3K4me1 matrix H3K4me1 count data 302 rows 59 columns H3K4me3 matrix H3K4me3 count data 5 rows 59 columns ATACSeq matrix ATACSeq count data 296 rows 123 columns","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/peak_counts.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example Peak Counts — peak_counts","text":"University Michigan","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/processCorrelations.html","id":null,"dir":"Reference","previous_headings":"","what":"Process correlation results — processCorrelations","title":"Process correlation results — processCorrelations","text":"Genes significant correlation either promoter distal peak retained focused .","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/processCorrelations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process correlation results — processCorrelations","text":"","code":"processCorrelations(count_mat, cor_res, correlation_pairs, p2g_info)"},{"path":"https://weitzela.github.io/PeakGeneNet/reference/removeBatchEffect_wrapper.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper: Remove Batch Effect This supplies the experimental model to remove technical variables, while protecting for the experimental variables. — removeBatchEffect_wrapper","title":"Wrapper: Remove Batch Effect This supplies the experimental model to remove technical variables, while protecting for the experimental variables. — removeBatchEffect_wrapper","text":"Wrapper: Remove Batch Effect supplies experimental model remove technical variables, protecting experimental variables.","code":""},{"path":"https://weitzela.github.io/PeakGeneNet/reference/removeBatchEffect_wrapper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper: Remove Batch Effect This supplies the experimental model to remove technical variables, while protecting for the experimental variables. — removeBatchEffect_wrapper","text":"","code":"removeBatchEffect_wrapper(   counts,   df,   var_adj,   var_protect = c(\"line\", \"sex\", \"grp\", \"train.sed\") )"}]
