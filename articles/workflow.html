<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>workflow â€¢ PeakGeneNet</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="workflow">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PeakGeneNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/workflow.html">workflow</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>workflow</h1>
            
      

      <div class="d-none name"><code>workflow.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="co"># pak::pak("weitzela/PeakGeneNet")</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://weitzela.github.io/PeakGeneNet/">PeakGeneNet</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="data-preparation">1. Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>Required objects:</p>
<ul>
<li><p>Gene counts: this is a matrix where the row names should be
ensembl IDs</p></li>
<li><p>Peak counts: a list object with one or more matrices. Matrices
should be in same format as gene counts, with row names as genomic
region where the chromosome names, start, and end locations are
separaated by a punctuation mark (e.g., chr1:123:456 or
chr1:123-456).</p></li>
</ul>
<p>Use these objects to create peak-gene pairs for inclusion in the
correlation analysis. The <code>p2g_info</code> provides information for
individual peaks per gene they will be correlated with. The
<code>correlation_pairs</code> object is used for reference for all of
the correlations that will be run.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2g_ls</span> <span class="op">=</span> <span class="fu"><a href="../reference/createPeak2GeneObjects.html">createPeak2GeneObjects</a></span><span class="op">(</span></span>
<span>  <span class="va">gene_counts</span>, <span class="va">peak_counts</span>, </span>
<span>  <span class="fu">biomaRt</span><span class="fu">::</span><span class="fu"><a href="https://huber-group-embl.github.io/biomaRt/reference/useEnsembl.html" class="external-link">useEnsembl</a></span><span class="op">(</span>biomart <span class="op">=</span> <span class="st">"genes"</span>, </span>
<span>                      dataset <span class="op">=</span> <span class="st">"rnorvegicus_gene_ensembl"</span>, version <span class="op">=</span> <span class="fl">109</span><span class="op">)</span>, </span>
<span>  <span class="st">"rn7"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p2g_ls</span><span class="op">$</span><span class="va">p2g_info</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span> <span class="op">|&gt;</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
unique_id
</th>
<th style="text-align:left;">
region_id
</th>
<th style="text-align:left;">
modality
</th>
<th style="text-align:left;">
ensembl_gene_id
</th>
<th style="text-align:right;">
dist_to_tss
</th>
<th style="text-align:left;">
promoter_peak
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
chr3:78634005:78634640_ATACSeq
</td>
<td style="text-align:left;">
chr3:78634005:78634640
</td>
<td style="text-align:left;">
ATACSeq
</td>
<td style="text-align:left;">
ENSRNOG00000000008
</td>
<td style="text-align:right;">
-977078
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
chr3:78652401:78653178_H3K4me1
</td>
<td style="text-align:left;">
chr3:78652401:78653178
</td>
<td style="text-align:left;">
H3K4me1
</td>
<td style="text-align:left;">
ENSRNOG00000000008
</td>
<td style="text-align:right;">
-958540
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
chr3:78652614:78653063_ATACSeq
</td>
<td style="text-align:left;">
chr3:78652614:78653063
</td>
<td style="text-align:left;">
ATACSeq
</td>
<td style="text-align:left;">
ENSRNOG00000000008
</td>
<td style="text-align:right;">
-958655
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
chr3:78683169:78683832_H3K27ac
</td>
<td style="text-align:left;">
chr3:78683169:78683832
</td>
<td style="text-align:left;">
H3K27ac
</td>
<td style="text-align:left;">
ENSRNOG00000000008
</td>
<td style="text-align:right;">
-927886
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
chr3:78683236:78683697_H3K4me1
</td>
<td style="text-align:left;">
chr3:78683236:78683697
</td>
<td style="text-align:left;">
H3K4me1
</td>
<td style="text-align:left;">
ENSRNOG00000000008
</td>
<td style="text-align:right;">
-928021
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2g_ls</span><span class="op">$</span><span class="va">correlation_pairs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span> <span class="op">|&gt;</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
ensembl_gene_id
</th>
<th style="text-align:left;">
regulatory_element
</th>
<th style="text-align:left;">
target_id
</th>
<th style="text-align:left;">
link_label
</th>
<th style="text-align:left;">
chr
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSRNOG00000000008
</td>
<td style="text-align:left;">
chr3:78634005:78634640_ATACSeq
</td>
<td style="text-align:left;">
chr3:79610922:79613046_H3K4me3
</td>
<td style="text-align:left;">
distal_peak_to_promoter_peak
</td>
<td style="text-align:left;">
chr3
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSRNOG00000000008
</td>
<td style="text-align:left;">
chr3:78652401:78653178_H3K4me1
</td>
<td style="text-align:left;">
chr3:79610922:79613046_H3K4me3
</td>
<td style="text-align:left;">
distal_peak_to_promoter_peak
</td>
<td style="text-align:left;">
chr3
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSRNOG00000000008
</td>
<td style="text-align:left;">
chr3:78652614:78653063_ATACSeq
</td>
<td style="text-align:left;">
chr3:79610922:79613046_H3K4me3
</td>
<td style="text-align:left;">
distal_peak_to_promoter_peak
</td>
<td style="text-align:left;">
chr3
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSRNOG00000000008
</td>
<td style="text-align:left;">
chr3:78683169:78683832_H3K27ac
</td>
<td style="text-align:left;">
chr3:79610922:79613046_H3K4me3
</td>
<td style="text-align:left;">
distal_peak_to_promoter_peak
</td>
<td style="text-align:left;">
chr3
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSRNOG00000000008
</td>
<td style="text-align:left;">
chr3:78683236:78683697_H3K4me1
</td>
<td style="text-align:left;">
chr3:79610922:79613046_H3K4me3
</td>
<td style="text-align:left;">
distal_peak_to_promoter_peak
</td>
<td style="text-align:left;">
chr3
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] PeakGeneNet_0.1.0 lubridate_1.9.4   forcats_1.0.1     stringr_1.6.0    </span></span>
<span><span class="co">#&gt;  [5] dplyr_1.1.4       purrr_1.2.1       readr_2.1.6       tidyr_1.3.2      </span></span>
<span><span class="co">#&gt;  [9] tibble_3.3.1      ggplot2_4.0.1     tidyverse_2.0.0  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] KEGGREST_1.50.0      gtable_0.3.6         httr2_1.2.2         </span></span>
<span><span class="co">#&gt;  [4] xfun_0.56            bslib_0.9.0          Biobase_2.70.0      </span></span>
<span><span class="co">#&gt;  [7] tzdb_0.5.0           vctrs_0.7.0          tools_4.5.2         </span></span>
<span><span class="co">#&gt; [10] generics_0.1.4       curl_7.0.0           stats4_4.5.2        </span></span>
<span><span class="co">#&gt; [13] AnnotationDbi_1.72.0 RSQLite_2.4.5        blob_1.3.0          </span></span>
<span><span class="co">#&gt; [16] pkgconfig_2.0.3      dbplyr_2.5.1         RColorBrewer_1.1-3  </span></span>
<span><span class="co">#&gt; [19] S7_0.2.1             desc_1.4.3           S4Vectors_0.48.0    </span></span>
<span><span class="co">#&gt; [22] lifecycle_1.0.5      compiler_4.5.2       farver_2.1.2        </span></span>
<span><span class="co">#&gt; [25] Biostrings_2.78.0    progress_1.2.3       tictoc_1.2.1        </span></span>
<span><span class="co">#&gt; [28] textshaping_1.0.4    Seqinfo_1.0.0        GenomeInfoDb_1.46.2 </span></span>
<span><span class="co">#&gt; [31] htmltools_0.5.9      sass_0.4.10          yaml_2.3.12         </span></span>
<span><span class="co">#&gt; [34] crayon_1.5.3         pillar_1.11.1        pkgdown_2.2.0       </span></span>
<span><span class="co">#&gt; [37] jquerylib_0.1.4      cachem_1.1.0         gtools_3.9.5        </span></span>
<span><span class="co">#&gt; [40] tidyselect_1.2.1     digest_0.6.39        stringi_1.8.7       </span></span>
<span><span class="co">#&gt; [43] biomaRt_2.66.0       fastmap_1.2.0        grid_4.5.2          </span></span>
<span><span class="co">#&gt; [46] cli_3.6.5            magrittr_2.0.4       withr_3.0.2         </span></span>
<span><span class="co">#&gt; [49] prettyunits_1.2.0    filelock_1.0.3       rappdirs_0.3.4      </span></span>
<span><span class="co">#&gt; [52] scales_1.4.0         UCSC.utils_1.6.1     bit64_4.6.0-1       </span></span>
<span><span class="co">#&gt; [55] timechange_0.3.0     XVector_0.50.0       rmarkdown_2.30      </span></span>
<span><span class="co">#&gt; [58] httr_1.4.7           bit_4.6.0            png_0.1-8           </span></span>
<span><span class="co">#&gt; [61] ragg_1.5.0           hms_1.1.4            memoise_2.0.1       </span></span>
<span><span class="co">#&gt; [64] kableExtra_1.4.0     evaluate_1.0.5       knitr_1.51          </span></span>
<span><span class="co">#&gt; [67] GenomicRanges_1.62.1 IRanges_2.44.0       BiocFileCache_3.0.0 </span></span>
<span><span class="co">#&gt; [70] viridisLite_0.4.2    rlang_1.1.7          glue_1.8.0          </span></span>
<span><span class="co">#&gt; [73] DBI_1.2.3            xml2_1.5.2           BiocGenerics_0.56.0 </span></span>
<span><span class="co">#&gt; [76] svglite_2.2.2        rstudioapi_0.18.0    jsonlite_2.0.0      </span></span>
<span><span class="co">#&gt; [79] R6_2.6.1             systemfonts_1.3.1    fs_1.6.6</span></span></code></pre></div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anne Weitzel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
